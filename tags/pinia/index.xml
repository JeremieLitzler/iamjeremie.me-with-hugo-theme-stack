<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Pinia on Jérémie Litzler</title><link>https://iamjeremie.me/tags/pinia/</link><description>Recent content in Pinia on Jérémie Litzler</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 04 Mar 2024 00:00:00 +0000</lastBuildDate><atom:link href="https://iamjeremie.me/tags/pinia/index.xml" rel="self" type="application/rss+xml"/><item><title>How to use a Pinia store within a navigation guard</title><link>https://iamjeremie.me/post/2024-03/how-to-use-a-pinia-store-within-a-navigation-guard/</link><pubDate>Mon, 04 Mar 2024 00:00:00 +0000</pubDate><guid>https://iamjeremie.me/post/2024-03/how-to-use-a-pinia-store-within-a-navigation-guard/</guid><description>&lt;img src="https://iamjeremie.me/post/2024-03/how-to-use-a-pinia-store-within-a-navigation-guard/images/2024-03-01-pinia-image-from.jpg" alt="Featured image of post How to use a Pinia store within a navigation guard" />&lt;p>If you are building a medium-sized application, you will end up using navigation guards to browse the different pages of your application.&lt;/p>
&lt;p>The basic use case is when you want to check an element exists before loading its details (for example on &lt;code>beforeEnter&lt;/code>).&lt;/p>
&lt;p>Now, if you are building the application with Vue 3 and Pinia, you will do this by querying a store.&lt;/p>
&lt;p>However, the application doesn’t load Pinia until the &lt;code>mount&lt;/code> call and you load the router before that…&lt;/p>
&lt;p>Therefore, Pinia will throw an error &lt;em>“getActivePinia()” was called but there was no active Pinia. Are you trying to use a store before calling “app.use(pinia)”? See &lt;a href="https://pinia.vuejs.org/core-concepts/outside-component-usage.html">https://pinia.vuejs.org/core-concepts/outside-component-usage.html&lt;/a> for help. This will fail in production.&lt;/em>&lt;/p>
&lt;p>What is the solution? I followed the steps of &lt;a href="https://stackoverflow.com/a/70714477">this Stackoverflow answer&lt;/a>.&lt;/p>
&lt;ol>
&lt;li>Create a &lt;code>pinia.ts&lt;/code> file to create the Pinia instance. Place it in the same location that you put your stores.&lt;/li>
&lt;li>Import it and call &lt;code>use&lt;/code> on the application instance in &lt;code>main.ts&lt;/code>&lt;/li>
&lt;li>Import it in &lt;code>src/router/index.ts&lt;/code> and provide it to your store instance: &lt;code>const store = useStore( pinia )&lt;/code>&lt;/li>
&lt;/ol>
&lt;p>The signature of the store &lt;code>useStory&lt;/code> doesn’t need to change. Providing the &lt;code>pinia&lt;/code> instance to the &lt;code>useStore()&lt;/code> is sufficient to make it work.&lt;/p></description></item></channel></rss>